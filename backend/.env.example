# RAF NET CCTV Backend Configuration
# ===================================

# Server Configuration
PORT=3001
HOST=0.0.0.0
NODE_ENV=production

# Database Configuration
DATABASE_PATH=./data/cctv.db

# ===================================
# JWT Configuration
# ===================================
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRATION=1h
JWT_REFRESH_EXPIRATION=7d

# ===================================
# MediaMTX Configuration
# ===================================

# Internal URLs - Backend uses these to communicate with MediaMTX directly
# These should always point to localhost since MediaMTX runs on same server
MEDIAMTX_API_URL=http://localhost:9997
MEDIAMTX_HLS_URL_INTERNAL=http://localhost:8888
MEDIAMTX_WEBRTC_URL_INTERNAL=http://localhost:8889

# ===================================
# Public Stream URLs Configuration
# ===================================
#
# ARCHITECTURE:
# Frontend -> Backend API -> MediaMTX (internal)
# Frontend NEVER accesses MediaMTX directly!
#
# For production (your domain):
PUBLIC_STREAM_BASE_URL=https://api-cctv.raf.my.id
PUBLIC_HLS_PATH=/hls
PUBLIC_WEBRTC_PATH=/webrtc

# ===================================
# Domain Configuration
# ===================================
# Backend API domain (used for HTTPS detection in cookies)
BACKEND_DOMAIN=api-cctv.raf.my.id
# Frontend domain (used for CORS)
FRONTEND_DOMAIN=cctv.raf.my.id
# Server IP (for direct IP access)
SERVER_IP=172.17.11.12

# ===================================
# CORS Configuration
# ===================================
# Use * to accept all origins (recommended for production behind nginx)
# Or comma-separated list: http://localhost:5173,https://your-domain.com
CORS_ORIGIN=*

# ===================================
# SECURITY CONFIGURATION
# ===================================

# --- API Key Validation ---
# Enable/disable API key validation (set to 'false' to disable)
API_KEY_VALIDATION_ENABLED=true
# Secret for API key generation (64-character hex string recommended)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
API_KEY_SECRET=your-64-character-hex-api-key-secret-change-this

# --- CSRF Protection ---
# Enable/disable CSRF protection (set to 'false' to disable)
CSRF_ENABLED=true
# Secret for CSRF token generation (32-character hex string recommended)
# Generate with: node -e "console.log(require('crypto').randomBytes(16).toString('hex'))"
CSRF_SECRET=your-32-character-hex-csrf-secret-change-this

# --- Rate Limiting ---
# Enable/disable rate limiting (set to 'false' to disable)
RATE_LIMIT_ENABLED=true
# Requests per minute for public endpoints
RATE_LIMIT_PUBLIC=100
# Requests per minute for auth endpoints
RATE_LIMIT_AUTH=30
# Requests per minute for admin endpoints
RATE_LIMIT_ADMIN=60

# --- Brute Force Protection ---
# Enable/disable brute force protection (set to 'false' to disable)
BRUTE_FORCE_ENABLED=true
# Maximum failed login attempts per username before lockout
MAX_LOGIN_ATTEMPTS=5
# Maximum failed login attempts per IP before blocking
MAX_IP_ATTEMPTS=10
# Account lockout duration in minutes
LOCKOUT_DURATION_MINUTES=30
# IP block duration in minutes
IP_BLOCK_DURATION_MINUTES=60

# --- Session Management ---
# Absolute session timeout in hours (forces re-login regardless of activity)
SESSION_ABSOLUTE_TIMEOUT_HOURS=24

# --- Password Policy ---
# Minimum password length
PASSWORD_MIN_LENGTH=12
# Maximum password age in days (forces password change)
PASSWORD_MAX_AGE_DAYS=90
# Number of previous passwords to remember (prevents reuse)
PASSWORD_HISTORY_COUNT=5

# --- Audit Logging ---
# Number of days to retain security audit logs
AUDIT_LOG_RETENTION_DAYS=90

# --- Allowed Origins ---
# Comma-separated list of allowed origins for CORS and origin validation
# Leave empty to auto-generate from FRONTEND_DOMAIN and SERVER_IP
# Format: https://domain,http://domain,http://ip:port,http://ip
ALLOWED_ORIGINS=

# ===================================
# TELEGRAM BOT CONFIGURATION
# ===================================
# Bot token from @BotFather
TELEGRAM_BOT_TOKEN=

# Chat ID untuk notifikasi monitoring kamera (offline/online alerts)
# Bisa berupa grup atau personal chat
TELEGRAM_MONITORING_CHAT_ID=

# Chat ID untuk notifikasi kritik & saran dari pengunjung
# Bisa sama dengan monitoring atau berbeda
TELEGRAM_FEEDBACK_CHAT_ID=
