# MediaMTX Configuration with On-Demand Streaming Logic

logLevel: info
logDestinations: [stdout]

# Listeners
api: yes
apiAddress: :9997
hls: yes
hlsAddress: :8888
webrtc: yes
webrtcAddress: :8889
rtmp: yes
rtmpAddress: :1935
rtsp: yes
rtspAddress: :8554

# Path Logic
paths:
  all:
    # When a stream is requested, run the backend script to fetch the source.
    # The script uses the MediaMTX API to add or update the path config.
    runOnDemand: node /var/www/rafnet-cctv/backend/sync_mediamtx.js
    runOnDemandRestart: yes
    runOnDemandStartTimeout: 10s
    runOnDemandCloseAfter: 10s
