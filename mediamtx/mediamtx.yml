# MediaMTX Configuration for RAF NET CCTV Production

# Logging
logLevel: info
logDestinations: [stdout]

# API for backend management
api: yes
apiAddress: :9997

# HLS settings - OPTIMIZED MODE (Stability + Memory Efficiency)
hls: yes
hlsAddress: :8888
hlsAlwaysRemux: yes
hlsAllowOrigin: '*'
# Segment duration: 2s (sweet spot for stability + reasonable latency)
hlsSegmentDuration: 2s
# Segment count: 7 (optimized - 14s buffer, 30% less RAM usage)
# History: 7 segments Ã— 2s = 14s (sufficient for stable playback, saves RAM)
hlsSegmentCount: 7
# RAM Disk storage for instant access
hlsDirectory: /dev/shm/mediamtx-live
# NOTE: hlsPartDuration REMOVED - No LL-HLS (reduces CPU load)

# WebRTC settings
webrtc: yes
webrtcAddress: :8889
webrtcAllowOrigin: '*'

# RTMP settings
rtmp: yes
rtmpAddress: :1935

# RTSP settings
rtsp: yes
rtspAddress: :8554

# Path configurations managed by backend
# Default path settings (applied to all camera paths)
paths:
  all_others:
    # RTSP source settings - OPTIMIZED
    sourceProtocol: tcp
    sourceOnDemand: yes
    sourceOnDemandStartTimeout: 5s      # Faster timeout (was 10s)
    sourceOnDemandCloseAfter: 60s       # Keep alive longer (was 30s)
